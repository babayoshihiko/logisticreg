--- 
title: "R によるロジスティック回帰"
author: "馬場美彦"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
bibliography: [book.bib, packages.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  本書は、医療介護福祉関係者を対象とした、ロジスティック回帰の解説書です。
  おもな題材としては、フレイルの研究論文としています。
  Clubhouse や介護の勉強会で集まった人たちと作り上げました。
link-citations: yes
github-repo: rstudio/bookdown-demo
---
```{r index-setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE)
options(kableExtra.latex.load_packages = FALSE)
library(kableExtra)
library(tidyverse)
library(epiDisplay)
library(MatchIt)
library(powerMediation)
library(powerSurvEpi)
library(pwrss)
library(samplesizelogisticcasecontrol)
library(WebPower)
```

# はじめに  {- #preface}

本書の目的は二つあります。

まず一つ目は、統計手法の一つであるロジスティック回帰について学ぶことです。ロジスティック回帰は、19世紀には発明されていましたが、医学の世界では 1948年に始まった Framingham Heart Study で採用され、広く使われるようになりました。

もう一つの目的は、フレイル (frailty)\index{ふれいる@フレイル}についての理解を深めることです。日本を含めて世界では高齢化が進行し、「フレイル」という状態の人が増えています。フレイル自体は病気ではなく、一度フレイルになってもまた頑健な状態に戻ることも可能です。一方、フレイルな状態は病気やケガにかかりやすい状態でもあります。

フレイルのように対象者が多く生活習慣に依存する状態の場合、ロジスティック回帰による研究は多くなります。多くの論文を読み、この２つのことについて理解を深めていきましょう。

## フレイル  {- #frailty}

フレイルとは、病気ではないけれど、年齢とともに、筋力や心身の活力が低下し、介護が必要になりやすい、健康と要介護の間の状態のことです。

フレイルの診断はいくつかあります。最もよく使われる、かつ簡単なものは、Fried による表現型 (phenotype) 法です。これは、以下の５つの項目のうち３項目以上当てはまる人をフレイル、１〜２項目当てはまる人をプレフレイル、０項目の人を頑健と定義します。

1. 体重減少
2. 主観的疲労感
3. 日常生活活動量の減少
4. 歩行速度の低下
5. 筋力の低下

一方、もっと細かく調査する方法もいくつかあります。例えば、Frailty Index があります [@searle2008standard]。

## 章の構成  {- #contents}

Chapter \@ref(intro) では、前提となる知識を確認します。まず、統計学のなかでのロジスティック回帰を解説します。ロジスティック回帰は、オッズ比を多変量に拡張したものです。

Chapter \@ref(overview) では、ロジスティック回帰分析の流れを、実際の論文を参照しながら追っていきます。ここでは、応答変数と説明変数について簡単に学びます。

続く Chapter \@ref(predictables) では、説明変数についてさらに深く学びます。説明変数をどのように決定するのか、いくつかの方法を実際の論文から学びます。図化として、メタ分析にも用いられるフォレストプロットも学びます。
 - 単変量と多変量
 - ステップワイズ
 - 多重共線性

第４章では、ロジスティック回帰における交互作用について解説します。交互作用はランダム化比較試験では重要な概念ですが、ロジスティック回帰ではあまり使われていないかもしれません。

これまで、応答変数は「生と死」や「疾患の有無」などすべて２値変数でした。第５章では、応答変数を３値以上に拡張する多項ロジスティックを説明します。

Chapter \@ref(predictables) では説明変数間は基本的に独立した関係が望ましいことを説明しました。この章ではその原則から少し外れて、階層構造を表す説明変数を持つマルチレベル解析について触れます。

これまで、ロジスティック回帰は正しい前提で話してきましたが、予測はどの程度正しいのでしょうか？第７章では、感度-特異度から ROC 曲線を作図する方法を説明します。

Chapter \@(propensityscore) は、傾向スコアをはじめとしたマッチングについて扱います。

Chapter \@(missing) は、欠損値 (欠測値) について学びます。

Chapter \@(samplesize) では、ロジスティック回帰を行う際のサンプルサイズの計算方法について学びます。

Chapter \@ref(machinelearning) では、機械学習について触れる。

なお、本書では数式を用いた理論などの説明は省略しています。これらについては、以下の書籍を参考にしてください。傾向スコアや多重代入法などの最新の話題には触れていませんが、十分に参考になります。

鶴田陽和 (2016) すべての医療系学生・研究者に贈る 独習統計学応用編24講: 分割表・回帰分析・ロジスティック回帰, 朝倉書店


## 著者について  {- #authors}

馬場美彦　（杏林大学）

青木和人　（鈴鹿大学短期大学部生活コミュニケーション学科）

住永みどり（大原保育医療福祉専門学校熊本校介護福祉学科、南阿蘇訪問介護事業）

住永実優　（ホーランドパークステートハイスクール、白梅学園玉名女子高等学校）

小野寺百合子　（立命館大学産業社会学部川﨑研究室）

